# AssemblerGui使用说明

AssemblerGui包含编辑器、汇编器、调试器三个部分。

## 编辑器
编辑器用来创建和修改MIPS文件。
编辑器包含的功能除了常见的新建、打开、保存、另存为等功能以外，还具备自动格式化代码的功能。
在保存文件后，点击编辑(E)->格式化代码(F)，即可将代码排版成4个空格缩进、5个字符宽度的大写指令名称、大写寄存器名称的格式。
如果MIPS文件的语法不正确，则会弹出错误对话框，指出错误发生的位置；单击对话框中的确定按钮，光标会自动跳转到相应的错误位置。

## 汇编器
汇编器用来将MIPS文件转换成各种格式的机器码。
在保存文件后，点击生成(B)，选择相应菜单项：

* Intel Hex文件：将当前MIPS文件转换为Intel格式的.hex文件，可以直接用于Quartus的ROM初始化
* 二进制机器码(B)：将当前MIPS文件转换为.txt文件，每行一个指令的机器码，用二进制表示
* 十六进制机器码(B)：将当前MIPS文件转换为.txt文件，每行一个指令的机器码，用十六进制表示
* 原始汇编(A)：将当前MIPS文件转换为另一MIPS文件，其中的扩展指令（原始指令集以外的指令）均展开成原始指令，所有行号和注释被删除，跳转指令用立即数表示
* 下载(D)：将当前MIPS文件转换成机器码，覆盖FPGA上的ROM内容

如果MIPS文件的语法不正确，或者汇编器运行中发生其他问题，则会弹出错误对话框，指出错误发生的位置；单击对话框中的确定按钮，光标会自动跳转到相应的错误位置。

## 调试器
调试器用来模拟MIPS文件的执行情况。

### 启动调试器
在保存文件后，点击调试(D)->开始执行(S)，即可启动调试器并立即开始执行程序（处于运行状态）。
点击调试(D)->逐指令(I)/逐语句(S)/逐过程(P)（三者效果相同），即可启动调试器但并不开始执行程序（处于暂停状态）。
处于暂停状态时，点击调试(D)->开始执行(S)，可以从当前位置开始执行程序（进入运行状态）。

### 暂停
在程序执行过程中（处于运行状态，标题栏中有Running字样时），可以点击调试(D)->暂停(P)来暂停程序的顺序执行，进入暂停状态。
此时可以通过右侧面板来查看、修改寄存器和主存储器的任意位置的值。
需要特别注意的是，修改程序计数器PC可能会导致意想不到的情况发生，包括程序执行异常、调试器异常终止、栈帧损坏等等；不要随意修改程序计数器PC！

### 断点
单击文件中某一行的最左侧，或者选择调试(D)->切换断点(B)，可以设置/清除这一行的断点。
若某一行有断点，则当程序执行到这一行时，会自动进入暂停状态，以供检查程序的执行情况。

### 单步
在暂停状态，点击调试(D)->逐指令(I)/逐语句(S)/逐过程(P)/跳出(J)，会进入有限的运行状态，也即其会自动返回暂停状态。
这几个菜单的具体作用如下：
* 逐指令：执行1条原始指令后立即返回暂停状态
* 逐语句：执行完当前行后返回暂停状态（对于原始指令，与“逐指令”效果相同；对于扩展指令，等效于多次执行“逐指令”）
* 逐过程：若当前行为函数调用，则在函数调用结束后返回暂停状态；否则与“逐语句”效果相同
* 跳出：当前函数执行完毕后立即进入暂停状态（通过栈帧进行判断）

### 退出调试器
不论当前处在运行状态还是暂停状态，点击调试(D)->停止执行(X)即可退出调试器并返回编辑器。
